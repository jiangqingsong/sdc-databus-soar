package com.broadtech.databus.soar.service;

/**
 * @program sdc-databus-soar
 * @description: 漏洞扫描服务接口类
 * @author: 蒋青松
 * @create: 2022/10/10 13:26
 */
public interface ScanVulnerabilityService {

    /**
     * -- 系统漏洞扫描录入
     *
     * @param target 需要扫描的站点IP地址或域名。如：www.example.com或者192.168.1.100。多个地址用英文逗号(,)分隔
     * @param user 扫描器用户名
     * @param pwd 扫描器密码
     * @return
     */
    String sysScanAdd(String target, String user, String pwd);

    /**
     *  -- WEB漏洞扫描录入
     *
     * 数据返回（json）：
     * 添加成功：
     * {"success":true, "taskid":1, "jobid":1 }
     * 添加失败：
     * {"success":false, "errorcode":1001}
     * 1001： 请输入必填参数。
     * 1002： 用户名或密码错误。
     * 1003： 名称已存在，请使用其他别名。
     * 1004： 许可文件受限，已达到最大任务资产数。
     * 1005： 扫描目标为空。
     * 1006： 任务ID（taskid）不存在。
     * 1007： 指定IP/域名（target）不存在。
     * 1008： 指定jobid不存在。
     * 1009： 暂无数据。
     * 1010：许可证已到期
     * @param target 需要扫描的站点IP地址或域名。如：www.example.com或者192.168.1.100。多个地址用英文逗号(,)分隔
     * @param user 扫描器用户名
     * @param pwd 扫描器密码
     * @return
     */
    String webScanAdd(String target, String user, String pwd);

    /**
     * -- 进度查询
     * 数据返回（json）：
     * 操作成功：
     * {"success":true , "status":0 , "progress": "50%" }
     * Status:
     * 0: 未提交
     * 1: 已提交
     * 2: 提交失败
     * 3: 正在运行
     * 4: 已完成
     * 5：已跳过
     * 6: 已停止
     * 7：已暂停
     * 8：等待
     * 9：已超时
     * 	Progress：执行进度0~100%，完成目标数/总目标数
     * 操作失败：
     * {"success":false, "errorcode":1001}
     * 1001： 请输入必填参数。
     * 1002： 用户名或密码错误。
     * 1003： 名称已存在，请使用其他别名。
     * 1004： 许可文件受限，已达到最大任务资产数。
     * 1005： 扫描目标为空。
     * 1006： 任务ID（taskid）不存在。
     * 1007： 指定IP/域名（target）不存在。
     * 1008： 指定jobid不存在。
     * 1009： 暂无数据。
     * @param taskId 添加成功后返回的任务ID
     * @param user 扫描器用户名
     * @param pwd 扫描器密码
     * @return
     */
    String getStatus(String taskId, String user, String pwd);

    /**
     * 系统漏洞扫描数据查询
     * 数据返回（json）：
     * 查询成功：
     * {
     * 	"success": true,
     *      "status": "completed",  --任务状态，完成= completed，正在运行=running
     * "vulnscount": 48,  --漏洞总数
     * "total": 1960,  --总计检测数
     * "cur": 1960,  --当前检测数
     *     "hostscount": 1,  --主机总数
     *     "hosts": [
     *         {
     *             "index": 0,  --序号
     * 		   "status": "completed", 	--单个状态，完成= completed，正在运行=running
     *             "vulinfo": 39,  --信息漏洞数
     *             "vulcritical": 1,  --严重漏洞数
     *             "cur": 1960,  --当前检测数
     *             "vulhigh": 1,  --高危漏洞数
     *             "vullow": 0,  --低危漏洞数
     *             "vulmedium": 7,  --中危漏洞数
     *             "vulcount": 48,  --漏洞总计
     *             "total": 1960,  --总计检测数
     *             "id": 2,  --ID
     *             "name": "49.4.162.66",  --名称
     *             "detail": {
     *                 "vulnscount": 48,  --漏洞总数
     *                 "end": "Wed Jul 29 11:35:51 2015",  --检测结束时间
     *                 "start": "Wed Jul 29 11:27:08 2015",  --检测开始时间
     *                 "mac": "00:1b:c0:b9:20:80",  --MAC地址
     *                 "ip": "49.4.162.66",  --IP地址
     *                 "os": "FortiOS on Fortinet FortiGate",  --操作系统
     * 			  "port_list": [                  --端口列表
     *                     {
     *                         "port": "22",
     * 					 "service": "ssh" ,
     * 					 "protocol": "SYN",   --协议类型：SYN/TCP/UDP
     *                                  }
     * 			  ]
     *                 "vulns": [
     *                     {
     *                         "pluginid": 52703,  --系统漏洞ID
     * 					 "pluginname": “SYN扫描服务漏洞”,  --系统漏洞名称
     * 					 "synopsis": “系统开启了SYN扫描”,  --系统漏洞概要
     * 					 "seealso": “http://mircosoft/see”,  --系统漏洞参考详情
     * 					 "groupname": “Linux安全”,  --系统漏洞分类名称
     * 					 "description": “漏洞描述”,  --系统漏洞
     * "cves": “CVE-2014-3566”,  --CVE
     * "bids": “32242”,  --Bugtraq ID
     * "cvss_vector": “CVSS2#AV:N/AC:M/Au:N/C:N/I:P/A:N”,  --CVSS
     * "cnnvd_list": [
     * 	{
     * 		"cnnvid"："CNNVD-201507-706"，
     * 		"cveid"：" CVE-2014-3566"， --cnnvid对应的cveid
     * 		" description"："cnnvid描述"，
     * 		" solution"："cnnvid解决办法"
     * }
     * ]
     *                         "count": 1,  --总计
     *                         "severity": 0,  --漏洞风险级别。严重=4，高=3，低=2，中=1，信息=0
     *                         "ports": [
     *                             {
     *                                 "info": "\n  Source  : 220 (vsFTPd 2.0.5)\n  Version : 2.0.5\n",  --漏洞详情（输出信息）
     *                                 "hosts": "49.4.162.66",  --漏洞详情（主机地址）
     *                                 "protocol": "tcp",  --漏洞详情（协议）
     *                                 "port": "21",  --漏洞详情（端口）
     *                                 "service": "ftp"  --漏洞详情（服务）
     *                             }
     *                         ]
     *                     }
     *                 ]
     *             }
     *         }
     *     ]
     * }
     * @param taskId 添加成功后返回的任务ID
     * @param user 扫描器用户名
     * @param pwd 扫描器密码
     * @return
     */
    String sysScanResultQuery(String taskId, String user, String pwd);

    /**
     * WEB漏洞扫描数据查询
     * 
     * @param taskId
     * @param user
     * @param pwd
     * @return
     */
    String webScanResultQuery(String taskId, String user, String pwd);
}
